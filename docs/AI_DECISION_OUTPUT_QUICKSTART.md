# AI å†³ç­–è¾“å‡ºä¿®å¤ - å¿«é€ŸæŒ‡å—

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. Agent Instructions å¢å¼º

**æ–‡ä»¶**ï¼š`src/agents/tradingAgent.ts`

**æ”¹åŠ¨**ï¼šåœ¨ Agent çš„ `instructions` æœ«å°¾æ·»åŠ äº†"å†³ç­–è¾“å‡ºè¦æ±‚"ç« èŠ‚ï¼Œæ˜ç¡®è¦æ±‚ AI å¿…é¡»è¾“å‡ºï¼š

- å¸‚åœºåˆ†ææ‘˜è¦ï¼ˆ2-3å¥è¯ï¼‰
- å†³ç­–ç†ç”±ï¼ˆ2-3å¥è¯ï¼‰
- æ‰§è¡ŒåŠ¨ä½œï¼ˆæ˜ç¡®åˆ—å‡ºï¼‰

### 2. å“åº”è§£æä¼˜åŒ–

**æ–‡ä»¶**ï¼š`src/scheduler/tradingLoop.ts`

**æ”¹åŠ¨**ï¼š

- æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼ˆæ­¥éª¤æ•°é‡ã€æ–‡æœ¬ä½ç½®ï¼‰
- ç»Ÿè®¡å·¥å…·è°ƒç”¨æ¬¡æ•°
- å¢å¼ºé”™è¯¯æç¤ºï¼ˆåˆ—å‡ºå¯èƒ½åŸå› ï¼‰
- è¾“å‡ºå·¥å…·è°ƒç”¨ç»Ÿè®¡

### 3. æ–‡æ¡£åˆ›å»º

- `docs/AI_DECISION_OUTPUT_FIX.md`ï¼šè¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- `docs/AI_DECISION_OUTPUT_VALIDATION.md`ï¼šéªŒè¯æŒ‡å—
- `scripts/validate-ai-decision.sh`ï¼šè‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬

## ğŸš€ ç«‹å³éªŒè¯

### æ–¹æ³• 1ï¼šè¿è¡Œç³»ç»Ÿè§‚å¯Ÿæ—¥å¿—

```bash
cd /home/losesky/nof1.ai
npm run dev
```

ç­‰å¾… 3-5 åˆ†é’Ÿï¼Œè§‚å¯Ÿæ—¥å¿—ä¸­çš„"ã€è¾“å‡º - AI å†³ç­–ã€‘"éƒ¨åˆ†ã€‚

**æœŸæœ›çœ‹åˆ°**ï¼š

```typescript
ã€è¾“å‡º - AI å†³ç­–ã€‘
================================================================================
å·¥å…·è°ƒç”¨ï¼š3 ä¸ª

ã€å¸‚åœºåˆ†æã€‘
BTCã€ETHã€DOGEå‡å‘ˆè¶‹åŠ¿å¸‚åœºçŠ¶æ€...

ã€å†³ç­–ç†ç”±ã€‘
BTCä¿¡å·å¼ºåº¦ä¼˜ç§€ï¼ˆ3ä¸ªæ—¶é—´æ¡†æ¶ä¸€è‡´ï¼‰...

ã€æ‰§è¡ŒåŠ¨ä½œã€‘
1. å¼€ä»“ï¼šBTCåšå¤šï¼Œ18%ä»“ä½ï¼Œ10å€æ æ†...
================================================================================
```

### æ–¹æ³• 2ï¼šä½¿ç”¨éªŒè¯è„šæœ¬

```bash
# è¿è¡Œç³»ç»Ÿè‡³å°‘ä¸€ä¸ªå‘¨æœŸå
./scripts/validate-ai-decision.sh
```

**è„šæœ¬åŠŸèƒ½**ï¼š

- âœ… æ£€æŸ¥æ•°æ®åº“ä¸­çš„æœ€è¿‘å†³ç­–è®°å½•
- âœ… éªŒè¯å†³ç­–æ˜¯å¦åŒ…å«"å¸‚åœºåˆ†æ"ã€"å†³ç­–ç†ç”±"ã€"æ‰§è¡ŒåŠ¨ä½œ"
- âœ… ç»™å‡ºè´¨é‡è¯„åˆ†å’Œè¯¦ç»†è¯Šæ–­

## ğŸ“Š æˆåŠŸæ ‡å‡†

1. **æ¯ä¸ªå‘¨æœŸéƒ½æœ‰ç»“æ„åŒ–è¾“å‡º**
   - åŒ…å«ä¸‰ä¸ªå…³é”®ç« èŠ‚
   - å†…å®¹å…·ä½“ä¸”å¯è¯»

2. **ä¸å†å‡ºç°é”™è¯¯æç¤º**
   - æ²¡æœ‰"AIè°ƒç”¨äº†å·¥å…·ä½†æœªäº§ç”Ÿå†³ç­–ç»“æœ"
   - æ²¡æœ‰è¶…æ—¶æˆ–ç½‘ç»œé”™è¯¯

3. **å†³ç­–ç¬¦åˆäº¤æ˜“è§„åˆ™**
   - é£é™©è¯„ä¼°åˆç†
   - ä»“ä½è®¡ç®—æ­£ç¡®
   - æ­¢æŸæ­¢ç›ˆè®¾ç½®æ°å½“

## ğŸ” å¦‚æœéªŒè¯å¤±è´¥

### åœºæ™¯ 1ï¼šä»ç„¶æ˜¾ç¤º"AIè°ƒç”¨äº†å·¥å…·ä½†æœªäº§ç”Ÿå†³ç­–ç»“æœ"

**æ£€æŸ¥ Agent Instructions**ï¼š

```bash
grep -A 20 "å†³ç­–è¾“å‡ºè¦æ±‚" src/agents/tradingAgent.ts
```

å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜ä¿®æ”¹æœªç”Ÿæ•ˆï¼š

```bash
# æŸ¥çœ‹æ–‡ä»¶å·®å¼‚
git diff src/agents/tradingAgent.ts

# é‡æ–°åº”ç”¨ä¿®æ”¹
git checkout src/agents/tradingAgent.ts
# ç„¶åé‡æ–°æ‰§è¡Œä¿®å¤æ­¥éª¤
```

### åœºæ™¯ 2ï¼šè¾“å‡ºæ ¼å¼ä¸ç¬¦åˆé¢„æœŸ

**å¯ç”¨ debug æ—¥å¿—**ï¼š

```bash
LOG_LEVEL=debug npm run dev 2>&1 | grep -A 5 "AIå“åº”åŒ…å«"
```

**æŸ¥çœ‹å®Œæ•´å“åº”ç»“æ„**ï¼Œè¯Šæ–­é—®é¢˜æ‰€åœ¨ã€‚

### åœºæ™¯ 3ï¼šæ¨¡å‹è¶…æ—¶æˆ–è¢«æˆªæ–­

**æ£€æŸ¥æ—¥å¿—ä¸­çš„è¶…æ—¶é”™è¯¯**ï¼š

```bash
cat logs/trading-loop.log | grep -i "timeout\|ETIMEDOUT"
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

- å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆåœ¨ `tradingAgent.ts` çš„ `fetch` å‡½æ•°ä¸­ï¼‰
- ç®€åŒ–æç¤ºè¯ï¼ˆå‡å°‘å†å²æ•°æ®ç‚¹ï¼‰
- åˆ‡æ¢æ›´å¿«çš„ AI æ¨¡å‹

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **æŠ€æœ¯æ–‡æ¡£**ï¼š`docs/AI_DECISION_OUTPUT_FIX.md`
   - è¯¦ç»†çš„é—®é¢˜åˆ†æå’Œè§£å†³æ–¹æ¡ˆ
   - ä»£ç æ”¹åŠ¨è¯´æ˜
   - ä¼˜åŒ–å»ºè®®

2. **éªŒè¯æŒ‡å—**ï¼š`docs/AI_DECISION_OUTPUT_VALIDATION.md`
   - è¯¦ç»†çš„éªŒè¯æ­¥éª¤
   - å¸¸è§é—®é¢˜è¯Šæ–­
   - æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡

3. **ä¼˜åŒ–æ€»ç»“**ï¼š`TRADING_AGENT_OPTIMIZATION.md`
   - æ‰€æœ‰ä¼˜åŒ–çš„æ€»è§ˆ
   - é˜¶æ®µæ€§è¿›åº¦
   - åç»­è®¡åˆ’

## ğŸ¯ ä¸‹ä¸€æ­¥

### å¦‚æœéªŒè¯é€šè¿‡

1. **æäº¤ä»£ç **ï¼š

   ```bash
   git add src/ docs/ scripts/
   git commit -m "ä¿®å¤ï¼šAI å†³ç­–è¾“å‡ºç¼ºå¤±é—®é¢˜"
   ```

2. **ç›‘æ§è¿è¡Œ**ï¼š
   - è¿ç»­è¿è¡Œ 1-2 å°æ—¶
   - ç»Ÿè®¡å†³ç­–è´¨é‡å’Œæ‰§è¡Œæ•ˆæœ
   - è®°å½•ä»»ä½•å¼‚å¸¸

3. **ä¼˜åŒ–è°ƒæ•´**ï¼š
   - å¦‚æœå†³ç­–è¿‡äºä¿å®ˆï¼Œè°ƒæ•´å…¥åœºæ¡ä»¶
   - å¦‚æœå†³ç­–æ–‡æœ¬è¿‡é•¿ï¼Œç®€åŒ–è¾“å‡ºè¦æ±‚
   - å¦‚æœå·¥å…·è°ƒç”¨è¿‡å¤šï¼Œä¼˜åŒ–æç¤ºè¯é€»è¾‘

### å¦‚æœéªŒè¯å¤±è´¥

1. **æ”¶é›†ä¿¡æ¯**ï¼š

   ```bash
   # ä¿å­˜å®Œæ•´æ—¥å¿—
   npm run dev 2>&1 | tee debug-$(date +%Y%m%d-%H%M%S).log
   
   # è¿è¡Œè¯Šæ–­è„šæœ¬
   ./scripts/validate-ai-decision.sh > validation-result.txt
   ```

2. **è¯Šæ–­é—®é¢˜**ï¼š
   - æŸ¥çœ‹ `debug-*.log` ä¸­çš„é”™è¯¯ä¿¡æ¯
   - åˆ†æ `validation-result.txt` çš„æ£€æŸ¥ç»“æœ
   - å‚è€ƒ `docs/AI_DECISION_OUTPUT_VALIDATION.md` çš„å¸¸è§é—®é¢˜éƒ¨åˆ†

3. **å¯»æ±‚å¸®åŠ©**ï¼š
   - æä¾›å®Œæ•´çš„æ—¥å¿—æ–‡ä»¶
   - æè¿°éªŒè¯å¤±è´¥çš„å…·ä½“ç°è±¡
   - åˆ—å‡ºå·²å°è¯•çš„è§£å†³æ–¹æ¡ˆ

## âš¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# è¿è¡Œç³»ç»Ÿ
npm run dev

# å¯ç”¨ debug æ—¥å¿—
LOG_LEVEL=debug npm run dev

# éªŒè¯å†³ç­–è¾“å‡º
./scripts/validate-ai-decision.sh

# æŸ¥çœ‹æœ€è¿‘å†³ç­–
sqlite3 ./.voltagent/trading.db "SELECT datetime(timestamp, 'localtime'), substr(decision, 1, 100) FROM agent_decisions ORDER BY timestamp DESC LIMIT 3;"

# æ£€æŸ¥æ—¥å¿—ä¸­çš„é”™è¯¯
cat logs/trading-loop.log | grep -E "ERROR|WARN|âš ï¸"

# ç»Ÿè®¡å†³ç­–ç±»å‹
sqlite3 ./.voltagent/trading.db "SELECT CASE WHEN decision LIKE '%å¼€ä»“%' THEN 'å¼€ä»“' WHEN decision LIKE '%å¹³ä»“%' THEN 'å¹³ä»“' ELSE 'è§‚æœ›' END as type, COUNT(*) FROM agent_decisions GROUP BY type;"
```

---

**ä¿®æ”¹æ—¶é—´**ï¼š2025-01-XX  
**éªŒè¯çŠ¶æ€**ï¼šå¾…æ‰§è¡Œ  
**é¢„æœŸç»“æœ**ï¼šAI è¾“å‡ºç»“æ„åŒ–å†³ç­–æ–‡æœ¬ï¼Œç³»ç»Ÿæ­£å¸¸è¿è¡Œ
